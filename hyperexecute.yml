version: "0.2"
runson: linux

pre:
  - npm install -g newman
  - npm install -g newman-reporter-htmlextra
  - newman --version
  - echo "Files in workspace:"
  - ls -la
  - test -f "Inwarranty-flow Collection.postman_collection.json" && echo "✅ Collection found" || echo "❌ NOT found"
  - test -f "QA.postman_environment.json" && echo "✅ Environment found" || echo "❌ NOT found"
  - test -f "testData.csv" && echo "✅ Test data found" || echo "❌ NOT found"

testDiscovery:
  type: raw
  mode: static
  command: echo "newman-test"

testRunnerCommand: |
  mkdir -p reports
  newman run "Inwarranty-flow Collection.postman_collection.json" \
    -e "QA.postman_environment.json" \
    -d "testData.csv" \
    --reporters cli,htmlextra \
    --reporter-htmlextra-export reports/newman-report.html \
    --verbose

post:
  - echo "Tests completed"
  - ls -la reports/

jobLabel: ['postman-api-tests']
